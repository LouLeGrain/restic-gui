{{define "content"}}
<div id="indexApp">
    <h2>
        <button id="new" type="button" class="btn btn-secondary">+</button>&nbsp;&nbsp;&nbsp;{{.Title}}</h2>
    <div id="indexApp"></div>
    <noscript><h2>Javascript needs to be enabled to send the payment!</h2></noscript>
    <div class="row">
        <div class="col-md-3">
            <div class="list-group">
            {{ range $_, $bu := .Backups }}
                <a href="#" backup-id="{{$bu.Id}}"
                   class="list-group-item list-group-item-action flex-column align-items-start">
                    <div class="d-flex w-100 justify-content-between">
                        <h6 class="mb-1">{{$bu.Name}}</h6>
                        <small>{{$bu.Type}} backup</small>
                    </div>
                    <p class="mb-1"></p>
                    <small>Source: {{$bu.Source}}<br/>Destination: {{ $bu.RepoPath }}</small>
                </a>
                <div id="sn_{{$bu.Id}}" class="list-group snapshots" style="display: none">&nbsp;</div>
            {{end}}
            </div>
        </div>
        <div class="col-md-9">
            Details
        </div>
    </div>
</div>

<script type="text/javascript">
    $(document).ready(function () {

        $('a').click(function (e) {
            e.preventDefault()
            console.log($(this).attr('backup-id'))
            $(this).tab('show')

        })

        var backups = JSON.parse('{{.Data}}');
        console.log(backups)
        /*

                showDetail(0);

                function showDetail(idx) {
                    var type = backups[idx].repoType;
                    //console.log(backups[idx])
                    $('#formBuName').val(backups[idx].backupName);
                    $('#formBuPath').val(backups[idx].backupPath);
                    $('#formRepoPath').val(backups[idx].repoPath);
                    $('#formRepoPasswd').val(backups[idx].repoPasswd);
                    $("input[name=type][value=" + type + "]").prop("checked", true);
                    checkValidPath(backups[idx].backupPath);
                }

                $("#formBuPath").blur(function (e) {
                    checkValidPath($(this).val());
                });

                $('.list-group-item').on('click', function () {
                    $('.list-group-item').removeClass('active');
                    $(this).addClass('active');
                    var idxStr = $(this).attr('id');
                    idx = idxStr.substring(4, idxStr.length);
                    showDetail(idx)
                })

                function checkValidPath(path) {
                    $.ajax({
                        url: "api/check/path",
                        type: 'POST',
                        data: '{"path":"' + path + '"}',
                        dataType: 'json',
                        beforeSend: function (xhr) {
                            xhr.overrideMimeType("text/plain; charset=x-user-defined")
                        }
                    }).done(function (response) {
                        if (!response.data) {
                            alert('Not a valid local path');
                            error.path = "Path error";
                            return false
                        }
                    });
                    return true
                }

                $("#details-form").submit(function (e) {
                    e.preventDefault();
                    console.log(error);
                    saveBuDetails()
                });

                function saveBuDetails() {
                    alert('save')
                }
        */
    })
</script>

{{end}}